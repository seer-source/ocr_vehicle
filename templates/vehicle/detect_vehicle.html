{% extends "livefeed/live_camera.html" %}
{% load static %}
{% block camera %}
<img id="video" style="width: 100%; height: 100% !important;" src="/vehicle/detect/{{camera.id}}" alt="loading.."  class="border rounded mt-2">
{% endblock camera %}
{% block scripts %}
<script src="{% static 'dist/js/team.js' %}"></script>
<script>
    $(function(){
        setInterval(()=>{
            $.ajax({
                url: `/result_vehicle/{{camera.id}}/`,
                type: 'GET',
                dataType: 'json',
                success: function (data) {
                    data.data.forEach(function (obj) {
                    var div=createCartVehicle(obj)
                    showDiv(obj,div)
            })
                },
                error: function (error) {

                    console.log('Error:', error);
                }
            });
    },500);
        
          });
    function showDiv(obj,div){
        if (!$("#resultCamera"+obj.id_camera+" #p"+obj.id_vehicle).length > 0) {
            $('#counter').text(Number($('#counter').text()) + 1);
              $("#resultCamera"+obj.id_camera).prepend(div);
          }
    }
    function createCartVehicle(obj){
        var newDiv = `
        <li id="p${obj.id_vehicle}" class="row align-items-center justify-items-center">
                <a href="#" target="_blank" class="col-10" >
                        <div class="me-2 d-flex align-items-center ">
                            <span class="avatar avatar-lg avatar-rounded" style="border: 3px solid green;">
                                <img src="${obj.label_image}" alt="">
                            </span>
                            <span class="ps-2" style="color:green">${obj.label}</span>
                        </div>   
                </a>           
            </li>
                `;
                return newDiv;
    }
</script>
{% endblock scripts %}
{% block models %}
{% endblock models %}



